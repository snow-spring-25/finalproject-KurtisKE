@page "/"
@using ClickRacer.Logic


<PageTitle>Click Racer</PageTitle>

@if (game.Player == null)
{
    <h3>Enter Your Name to Start</h3>
    <input @bind="PlayerNameInput" placeholder="Put your name here" />
    <button @onclick="StartGame">Start Game</button>
}
else
{
    <p>@game.Player.Name's Bank: @game.Player.Money</p>

    <button @onclick="Click">Tire.jpg (+@game.Player.ClickValue)</button>

    <h4>Sponsors</h4>
    @foreach (var upgrade in game.Sponsers)
    {
        <div>
            <button @onclick="() => BuyUpgrade((ClickUpgrade)upgrade)" disabled="@(game.Player.Money < upgrade.Cost)">
                Buy @upgrade.Name (Cost: @upgrade.Cost, +@upgrade.Bonus per click)
            </button>
        </div>
    }
    <h4>Drivers Available</h4>
@if (GameRunner.AvailableDrivers.Count == 0)
{
    <p>All drivers have been drafted!</p>
}
else
{
    @foreach (var driver in GameRunner.AvailableDrivers)
    {
        <div>
            <button @onclick="() => BuyDriver(driver.Name)" disabled="@(game.Player.Money < driver.Cost)">
                Buy @driver.Name (Cost: $@driver.Cost, Skill: @driver.SkillLevel)
            </button>
        </div>
    }
}

<h4>Your Drivers</h4>
@if (game.Player.TeamDrivers.Count == 0)
{
    <p>You haven’t hired any drivers yet.</p>
}
else
{
    <ul>
        @foreach (var driver in game.Player.TeamDrivers)
        {
            <li>@driver.Name (Skill: @driver.SkillLevel)</li>
        }
    </ul>
}

}



@code {
    private string PlayerNameInput = "";
    public GameRunner game = new();

    private void StartGame() => game.StartGame(PlayerNameInput);
    private void Click() => game.Click();
    private void BuyUpgrade(ClickUpgrade upgrade) => game.BuyUpgrade(upgrade);
    private void BuyDriver(string name) => game.TryBuyDriver(name);
}